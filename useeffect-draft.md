まず副作用 = 外部システムとのやり取り とした後、
「すべての副作用 = 外部システムとのやり取り は、何かの事象に反応して発生するトリガ処理とみなすことができる」と明言する

React でアプリケーションを構築するときに記述する副作用を区分してみると、いくつかのパターンが存在する

- 1. React が DOM ノードを mount/unmount したタイミングで 外部のシステムを初期化・破棄 する副作用
- 2. React 内部の state に基づいて、外部システム に その値を反映する 副作用
- 3. 何かのイベントに応じて 実行される副作用

React 公式は これらを

- 1. 何かの事象 = React が DOM ノードを mount/unmount したという事象に対するトリガ である場合
  - エフェクトを利用せよ、具体的には useEffect の setup 関数に記述せよ
- 2. 1 の事象に加え、React の state が変化したという事象に対するトリガである場合
  - 依存配列に state も含めてエフェクトを利用せよ、具体的には (省略)
- 3. 何かの事象 = ユーザ(人間)が意図を持って行った操作に対するトリガ である場合
  - イベントハンドラ イベントハンドラ を利用せよ、具体的にはイベントハンドラとして コールバック関数内に記述せよ

と分離して区別している

続いて、各パターンの処理の流れを見ていく

- 1. 処理の流れ
  - useEffect を用いて副作用を登録 → DOM ノードがマウント・アンマウントされたという事象に基づいて副作用を実行
- 2. 処理の流れ
  - useEffect を用いて副作用を登録 → DOM ノードがマウント・アンマウントされたという事象に加え、state が変更されたという事象に基づいて副作用を実行

3 については少しややこしい

- 3. 処理の流れ
  - 「何らかの手段」で イベントハンドラという副作用を登録 → 任意のイベントに基づいて副作用を実行 (onClick など)

この「何らかの手段」とは以下の 2 つの方法が考えられる

- a. イベントハンドラ属性を用いて登録する場合 (例: JSX の onClick 属性)
- b. useEffect 内で イベントハンドラを登録・削除する場合 (例: DOM の addEventListener / removeEventListener)

b の方法でイベントハンドラを登録するということは、
1 のパターンをイベントハンドラ登録に応用していると考えることができる

これを踏まえて、処理の流れを見ていく

- 3a. 処理の流れ
  - イベントハンドラ属性を用いて副作用を登録 → 任意のイベントに基づいて副作用を実行
- 3b. 処理の流れ
  - useEffect を用いて副作用を登録 → DOM ノードがマウント・アンマウントされるイベントに基づいて イベントハンドラという副作用を登録・削除 → 任意のイベントに基づいて副作用を実行
